{% extends "layout.html" %}
{% block content %}
    <div class="container d-flex justify-content-center my-4">
        <h2>{% block tit %}{% endblock tit %}</h2>
    </div>
    <div class="py-1" style="background-color: var(--btn-color-sec)">
        <div class="container d-flex justify-content-center my-4">
            <h3>Face Swap</h3>
        </div>

        <div class="container py-3">
            <div class="row">
                <div class="col-12 col-lg-3">
                    <ul>
                       <li>
                           {% block fs_li_1 %}{% endblock fs_li_1 %}
                       </li>
                       <li>
                           {% block fs_li_2%}{% endblock fs_li_2%}
                       </li>
                       <li>
                           {% block fs_li_3%}{% endblock fs_li_3%}
                       </li>
                       <li>
                           {% block fs_li_4%}{% endblock fs_li_4%}
                       </li>
                    </ul>

                </div>
                <div class="col-12 col-lg-3 py-2">
                    <div class="card" style="height: 300px">
                        <img id="fs-1" src="{{ url_for('static', filename='images/no_image.webp') }}"
                             style="max-height: 255px; min-height: 255px; width: auto;"
                             class="card-img-top clickable-image" data-source="-" alt="No Image">
                        <div class="card-footer dropdown-toggle playground-style-1" id="dropdown-fs-1"
                             data-bs-toggle="dropdown" aria-expanded="false" style="margin-left: -1px;
                              margin-right: -1px; margin-bottom: -1px; z-index: 100">
                            {% block sel1 %}{% endblock sel1 %} 1
                            <ul class="dropdown-menu dropdown-menu-1" aria-labelledby="dropdownMenuButton">
                                <li><a class="dropdown-item" href="#" onclick="changeImage('fs-1', 'jb.webp', 'jb',
                                 'https://www.whitehouse.gov/administration/president-biden/')">
                                    Joe Biden, {% block jb %}{% endblock jb %}
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="changeImage('fs-1', 'jib.jpg', 'jib',
                                 'https://commons.wikimedia.org/wiki/File:Ji%C5%99ina_Bohdalov%C3%A1_2019.jpg')">
                                    Jiřina Bohdalová, {% block jib %}{% endblock jib %}
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="changeImage('fs-1', 'rdj.webp', 'rdj',
                                 'https://www.britannica.com/biography/Robert-Downey-Jr#/media/1/1475941/298010')">
                                    Robert Downey Jr., {% block rdj %}{% endblock rdj %}
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="changeImage('fs-1', 'pp.webp', 'pp',
                                'https://www.novinky.cz/tag/petr-pavel-58345')">
                                    Petr Pavel, {% block pp %}{% endblock pp %}
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="changeImage('fs-1', 'ts.jpg', 'ts',
                                 'https://people.com/music/taylor-swift-releases-four-new-songs-eras-tour/')">
                                    Taylor Swift, {% block ts %}{% endblock ts %}
                                </a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-3 py-2">
                    <div class="card" style="height: 300px">
                        <img id="fs-2" src="{{ url_for('static', filename='images/no_image.webp') }}"
                             style="max-height: 255px; min-height: 255px; width: auto;"
                             class="card-img-top clickable-image" data-source="-" alt="No Image">
                        <div class="card-footer dropdown-toggle playground-style-1" id="dropdown-fs-2"
                             data-bs-toggle="dropdown" aria-expanded="false" style=" margin-left: -1px;
                              margin-right: -1px; margin-bottom: -1px; z-index: 100">
                            {% block sel2 %}{% endblock sel2 %} 2
                            <ul class="dropdown-menu dropdown-menu-1" aria-labelledby="dropdownMenuButton">
                                <li><a class="dropdown-item" href="#" onclick="changeImage('fs-2', 'jb.webp', 'jb',
                                 'https://www.whitehouse.gov/administration/president-biden/')">
                                    Joe Biden, {% block jb2 %}{% endblock jb2 %}
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="changeImage('fs-2', 'jib.jpg', 'jib',
                                 'https://commons.wikimedia.org/wiki/File:Ji%C5%99ina_Bohdalov%C3%A1_2019.jpg')">
                                    Jiřina Bohdalová, {% block jib2 %}{% endblock jib2 %}
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="changeImage('fs-2', 'rdj.webp', 'rdj',
                                 'https://www.britannica.com/biography/Robert-Downey-Jr#/media/1/1475941/298010')">
                                    Robert Downey Jr., {% block rdj2 %}{% endblock rdj2 %}
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="changeImage('fs-2', 'pp.webp', 'pp',
                                'https://www.novinky.cz/tag/petr-pavel-58345')">
                                    Petr Pavel, {% block pp2 %}{% endblock pp2 %}
                                </a></li>
                                <li><a class="dropdown-item" href="#" onclick="changeImage('fs-2', 'ts.jpg', 'ts',
                                 'https://people.com/music/taylor-swift-releases-four-new-songs-eras-tour/')">
                                    Taylor Swift, {% block ts2 %}{% endblock ts2 %}
                                </a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-3 py-2">
                    <div class="card" style="height: 300px">
                        <img id="fs" src="{{ url_for('static', filename='images/no_image.webp') }}"
                             style="max-height: 255px; min-height: 255px; width: auto;"
                             class="card-img-top clickable-image"
                             alt="No Image" data-source="-">
                        <button class="card-footer playground-style-1" onclick="faceswap()">
                            {% block fs %}{% endblock fs %} Deepfake
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>



<!--    <div class="py-1">-->
<!--        <div class="container d-flex justify-content-center my-4">-->
<!--            <h3>Face Manipulation</h3>-->
<!--        </div>-->
<!--        <div class="container my-2 text-end">-->
<!--            FACE MANIP-->
<!--        </div>-->
<!--    </div>-->


    <div class="py-3" style="background-color: var(--btn-color-how); color: var(--main-bg-color)">
        <div class="container d-flex justify-content-center my-4">
            <h3 style="color: var(--main-bg-color)">Face Morphing</h3>
        </div>
        <div class="container py-3 my-auto">
            <div class="row">
                <div class="col-12 col-md-9">
                    <div class="card" style="min-height: 350px">
                        <div class="row px-1 py-1" style="min-height: 300px">
                            <div class="col-12 col-md-4 py-1">
                                <img id="fm-1" src="{{ url_for('static', filename='images/no_image.webp') }}"
                                     style="border-radius: 2rem; max-height: 300px"
                                     class="card-img-top clickable-image object-fit-cover" data-source="-" alt="No Image">
                            </div>
                            <div class="col-12 col-md-4 py-1">
                                <img id="fm-2" src="{{ url_for('static', filename='images/no_image.webp') }}"
                                     style="max-height: 300px; border-radius: 2rem"
                                     class="card-img-top clickable-image object-fit-cover" data-source="-" alt="No Image">
                            </div>
                            <div class="col-12 col-md-4 py-1">
                                <img id="fm-3" src="{{ url_for('static', filename='images/no_image.webp') }}"
                                     style="border-radius: 2rem; max-height: 300px"
                                     class="card-img-top clickable-image object-fit-cover" data-source="-" alt="No Image">
                            </div>
                        </div>

                        <div class="card-footer dropdown-toggle" id="dropdownMenuButton2" data-bs-toggle="dropdown"
                             aria-expanded="false" style="color: var(--text-color-pri);
                              background-color: var(--btn-color-sec);
                              margin-left: -1px; margin-right: -1px; margin-bottom: -1px;">
                            {% block fmi %}{% endblock fmi %}
                            <ul class="dropdown-menu dropdown-menu-2" aria-labelledby="dropdownMenuButton2">
                                <li><a class="dropdown-item text-middle" href="#" onclick="changeMorph(1)">
                                    {% block fmi1 %}{% endblock fmi1 %}
                                </a></li>
                                <li><a class="dropdown-item text-middle" href="#" onclick="changeMorph(2)">
                                    {% block fmi2 %}{% endblock fmi2 %}
                                </a></li>
                                <li><a class="dropdown-item text-middle" href="#" onclick="changeMorph(3)">
                                    {% block fmi3 %}{% endblock fmi3 %}
                                </a></li>
                                <li><a class="dropdown-item text-middle" href="#" onclick="changeMorph(4)">
                                    {% block fmi4 %}{% endblock fmi4 %}
                                </a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-3 my-auto order-first order-md-last">
                    <ul>
                        <li>
                            {% block fm1 %}{% endblock fm1 %}
                        </li>
                        <li>
                            {% block fm2 %}{% endblock fm2 %}
                        </li>
                        <li>
                            {% block fm3 %}{% endblock fm3 %}
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <div class="container py-1">
        <div class="container d-flex justify-content-center my-4">
            <h3>Facial Reenactment</h3>
        </div>
        <div class="row mb-4">
            <div class="col-12 col-md-7 my-auto">
                <div class="container">
                    <div id="carouselExample" class="carousel slide">
                      <div class="carousel-inner">
                        <div class="carousel-item active ratio ratio-16x9">
                            <iframe class="object-fit-fill"
                                    src="https://www.youtube.com/embed/rh3ZETDHC58?si=mnjMzF3eGoZJNxib" allowfullscreen>
                            </iframe>
                        </div>
                        <div class="carousel-item ratio ratio-16x9">
                            <iframe class="object-fit-fill"
                                    src="https://www.youtube.com/embed/nwOywe7xLhs?si=73h50ksExP9hYvzR" allowfullscreen>
                            </iframe>
                        </div>
                        <div class="carousel-item ratio ratio-16x9">
                            <iframe class="object-fit-fill"
                                    src="https://www.youtube.com/embed/Xe1_L-a-nSI?si=8OcBS3lDYxy-04_Y" allowfullscreen>
                            </iframe>
                        </div>
                        <div class="carousel-item ratio ratio-16x9">
                            <iframe class="object-fit-fill"
                                    src="https://www.youtube.com/embed/CgalwypZ27w?si=7Xh4pFeua_8sxTac" allowfullscreen>
                            </iframe>
                        </div>
                        <div class="carousel-item ratio ratio-16x9">
                            <iframe class="object-fit-fill"
                                    src="https://www.youtube.com/embed/teio7bw3xrM?si=TzEFVY5LZkmpthKY" allowfullscreen>
                            </iframe>
                        </div>
                      </div>
                      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample"
                              data-bs-slide="prev" style="position: absolute; left: -12%">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                      </button>
                      <button class="carousel-control-next" type="button" data-bs-target="#carouselExample"
                              data-bs-slide="next" style="position: absolute; right: -12%">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                      </button>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-5 pe-md-5 my-auto order-first ">
<!--            <div class="col-12 col-md-5 pe-5 order-md-last pe-md-0 ps-md-5 my-auto order-first ">-->
                <ul>
                    <li>
                        <p class="text">{% block free1 %}{% endblock free1 %}</p>
                    </li>
                    <ul>
                        <li>
                            <p class="text">{% block free2 %}{% endblock free2 %}</p>
                        </li>
                        <li>
                            <p class="text">{% block free3 %}{% endblock free3 %}</p>
                        </li>
                    </ul>
                    <li>
                        <p class="text">{% block free4 %}{% endblock free4 %}</p>
                    </li>
                </ul>
            </div>
        </div>
    </div>




    <div class="py-1" style="background-color: #0D302E;">
        <div class="container d-flex justify-content-center my-4">
            <h3>Text-to-speech</h3>
        </div>
        <div class="container my-3 py-3">
            <div class="row justify-content-between">
                <div class="col-12 col-md-5">
                    <ul>
                        <li>
                            dasda
                        </li>
                        <li>
                            dasda
                        </li>
                    </ul>
                </div>
                <div class="col-12 col-md-6 order-first">
                    <div class="row">
                        <audio controls>
                          <source id="tts" src="" type="audio/mpeg">
                            Your browser does not support the audio element.
                        </audio>
                    </div>
                    <div class="row py-3">
                        <div class="col-6 py-auto my-auto">
                            <div class="row">
                                <div class="btn dropdown-toggle playground-style-1 btn-audio" id="dropdown-tts-1"
                                     data-bs-toggle="dropdown" aria-expanded="false">
                                    {% block source %}{% endblock source %}
                                    <ul class="dropdown-menu dropdown-menu-1" aria-labelledby="dropdownMenuButton"
                                        style="max-width: 100vw;">
                                        <li><a class="dropdown-item" href="#" onclick="tts(1, 1)">
                                            Donald Trump
                                        </a></li>
                                        <li><a class="dropdown-item" href="#" onclick="tts(1, 2)">
                                            Miloš Zeman
                                        </a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="row">
                                <div class="btn dropdown-toggle playground-style-1 btn-audio" id="dropdown-tts-2"
                                     data-bs-toggle="dropdown" aria-expanded="false">
                                    {% block sentence %}{% endblock sentence %}
                                    <ul class="dropdown-menu dropdown-menu-1" aria-labelledby="dropdownMenuButton"
                                        style="max-width: 98vw;">
                                        <li><a class="dropdown-item" href="#" onclick="tts(2, 1)"
                                               style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                            The Godfather - I'm gonna make him an offer he can't refuse.
                                        </a></li>
                                        <li><a class="dropdown-item" href="#" onclick="tts(2, 2)"
                                               style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                            Franklin D. Roosevelt - The only thing we have to fear is fear itself.
                                        </a></li>
                                        <li><a class="dropdown-item" href="#" onclick="tts(2, 3)"
                                               style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                            Albert Einstein - Pouze dvě věci jsou nekonečné. Vesmír a lidská hloupost.
                                            U té první si tím však nejsem tak jist.
                                        </a></li>
                                        <li><a class="dropdown-item" href="#" onclick="tts(2, 4)"
                                               style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                            Oscar Wilde - Nikdy neodkládám na zítřek, co lze udělat pozítří.
                                        </a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 py-auto my-auto">
                            <div class="card text-center">
                              <ul class="list-group list-group-flush">
                                <li id="speaker" class="list-group-item" style="background-color: var(--card-bg-color);
                                 color: var(--text-color-pri); border-color: var(--text-color-pri)">---</li>
                                <li id="sentence" class="list-group-item" style="background-color: var(--card-bg-color);
                                 color: var(--text-color-pri)">---</li>
                              </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>





    <!--    CONT/END BUTTONS-->
    <div class="container my-4 d-flex justify-content-center">
        <div class="fixed-sm-bottom mb-1">
            <div class="row">
                <div class="col-12 col-md-6 my-2 order-last order-md-first text-center">
                    <a class="btn btn-my-secondary" href="{{ url_for('end') }}">{% block but1 %}{% endblock but1 %}</a>
                </div>
                <div class="col-12 col-md-6 my-2 text-center">
                    <a class="btn btn-my-primary" href="{{ url_for('test') }}">{% block but2 %}{% endblock but2 %}</a>
                </div>
            </div>
        </div>
    </div>

<!-- Modal -->
<div class="modal fade modal-xl" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="mx-auto modal-body">
        <img id="modalImage" class="modal-content" src="{{ url_for('static', filename='images/collage2.png') }}"
             alt="Modal Image" style="max-height: 80vh; width: auto;">
      </div>
      <div class="modal-footer">
        <p style="display: inline">{% block src %}{% endblock src %}: </p>
        <a id="src"></a>
      </div>
    </div>
  </div>
</div>

<script>
    // changes source to the result of faceswap between 2 images user selected
    function faceswap() {
        let cardImage = document.getElementById('fs');
        let image1 = document.getElementById('fs-1');
        let image2 = document.getElementById('fs-2');

        let src = "/static/images/no_image.webp"

        if (image1.name !== '' && image2.name !== '') {
            if (image1.name === image2.name)
                src = image1.src
            else
                src = "/static/images/face_swap/" + image2.name + "_to_" + image1.name + ".png";

            cardImage.setAttribute("data-source", "https://remaker.ai/face-swap-free/");
        }
        cardImage.src = src
    }


    // changes image to a different one alongside it's data
    function changeImage(card, image, name, source) {
        let cardImage = document.getElementById(card);
        cardImage.src = "/static/images/face_swap/" + image;
        cardImage.name = name;
        cardImage.setAttribute("data-source", source);
    }

    let modalImage = document.getElementById("modalImage");
    let images = document.querySelectorAll(".clickable-image");

    // Loop through the images and add click event listeners
    images.forEach(function(image) {
        image.addEventListener("click", function() {
            image.setAttribute("data-bs-toggle", "modal");
            image.setAttribute("data-bs-target", "#imageModal");
            modalImage.src = this.src;

            let source = "";
            if (this.src !== "") {
                source = this.getAttribute('data-source');
            }
            document.getElementById("src").innerText = source;
        });
    });

    // changes face morph card's images
    function changeMorph(images) {
        let im1 = document.getElementById('fm-1');
        let im2 = document.getElementById('fm-2');
        let im3 = document.getElementById('fm-3');

        im2.setAttribute("data-source", "https://facemorph.me");

        if (images === 1) {
            im1.src = "/static/images/face_morph/babis.jpg";
            im2.src = "/static/images/face_morph/babis_fiala.png";
            im3.src = "/static/images/face_morph/fiala.jpg";

            im1.setAttribute("data-source", "https://www.psp.cz/sqw/hp.sqw?k=192");
            im3.setAttribute("data-source", "https://www.psp.cz/sqw/hp.sqw?k=192");

        } else if (images === 2) {
            im1.src = "/static/images/face_morph/elon.webp";
            im2.src = "/static/images/face_morph/elon_rock.png";
            im3.src = "/static/images/face_morph/rock.webp";

        } else if (images === 3) {
            im1.src = "/static/images/face_morph/adele.webp";
            im2.src = "/static/images/face_morph/adele_bila.png";
            im3.src = "/static/images/face_morph/bila.webp";

        } else {
            im1.src = "/static/images/face_morph/beast.webp";
            im2.src = "/static/images/face_morph/beast_bean.png";
            im3.src = "/static/images/face_morph/bean.webp";
        }
    }

    // changes card element text for tts
    function tts(dropdown, val) {
        let speaker = document.getElementById('speaker')
        let sentence = document.getElementById('sentence')

        if (dropdown === 1) {
            if (val === 1) {
                speaker.innerText = "Donald Trump";
                speaker.value = '1';
            }
            else {
                speaker.innerText = "Miloš Zeman";
                speaker.value = '2';
            }

        } else {
            if (val === 1) {
                sentence.innerText = "The Godfather";
                sentence.value = '1';
            }
            else if (val === 2) {
                sentence.innerText = "Franklin D. Roosevelt";
                sentence.value = '2';
            }
            else if (val === 3) {
                sentence.innerText = "Albert Einstein";
                sentence.value = '3';
            }
            else {
                sentence.innerText = "Oscar Wilde";
                sentence.value = '4';
            }
        }

        if (speaker.value !== 0 && sentence.value !== 0) {
            let deepfake = speaker.value.toString() + sentence.value.toString();
            let audio = document.getElementById('tts');
            audio.src = '/static/audio/' + deepfake;
        }
    }
</script>

{% endblock content %}